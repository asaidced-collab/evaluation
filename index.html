<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงุณุชูุงุฑุฉ ุชุญููู ุงูููุงุฑุณุงุช ุงูุชุฑุจููุฉ ุงูุฏุงูุฌุฉ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #3498db, #2980b9);
            border-radius: 4px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .page-title {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #3498db;
        }

        .page-subtitle {
            font-size: 1.1em;
            color: #666;
            margin-bottom: 25px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
        }

        .radio-group label {
            font-weight: normal;
            margin-bottom: 0;
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            transition: all 0.3s;
        }

        .radio-group label:hover {
            border-color: #3498db;
            background: #f0f8ff;
        }

        .radio-group input[type="radio"] {
            margin-left: 8px;
            margin-right: 5px;
        }

        .radio-group input[type="radio"]:checked + span {
            color: #3498db;
            font-weight: bold;
        }

        .item-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            transition: all 0.3s;
            position: relative;
        }

        .item-card:hover {
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.15);
        }

        .item-card.invalid {
            border-color: #e74c3c;
            background-color: #fff5f5;
        }

        .item-number {
            position: absolute;
            top: -10px;
            right: 15px;
            background: #3498db;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .item-text {
            font-size: 1.1em;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-right: 60px;
            line-height: 1.7;
            font-weight: 500;
        }

        .conditional-section {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        .conditional-section.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; max-height: 0; }
            to { opacity: 1; max-height: 200px; }
        }

        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }

        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .error-message {
            color: #e74c3c;
            background: #fdf2f2;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
        }

        .invalid {
            border-color: #e74c3c !important;
            background-color: #fff5f5 !important;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .checkbox-group label:hover {
            border-color: #3498db;
            background: #f0f8ff;
        }

        .checkbox-group input[type="checkbox"] {
            margin-left: 8px;
            margin-right: 5px;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .radio-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ุงุณุชูุงุฑุฉ ุชุญููู ุงูููุงุฑุณุงุช ุงูุชุฑุจููุฉ ุงูุฏุงูุฌุฉ</h1>
            <p>ุงููููุงุณ ุงูููุฏุงูู ููุฏู ุงูุชุฒุงู ุฃุณุงุชุฐุฉ ุงูุชุนููู ุงูุงุจุชุฏุงุฆู ุจุงูููุงุฑุณุงุช ุงูุชุฑุจููุฉ ุงูุฏุงูุฌุฉ ููุชูุงููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ</p>
        </div>

        <div class="content">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <!-- ุตูุญุฉ ุงูุชุฑุญูุจ -->
            <div class="page active" id="page0">
                <div class="page-title">ูุฑุญุจุงู ุจูู ูู ุงุณุชูุงุฑุฉ ุงูุชุญููู</div>
                
                <div class="page-subtitle">
                    <strong>ุงูุบุฑุถ ูู ุงูุชุญููู:</strong> ุชูููู ุฌูุฏุฉ ุฃุฏุงุฉ ููุงุณ ูุฏู ุงูุชุฒุงู ุฃุณุงุชุฐุฉ ุงูุชุนููู ุงูุงุจุชุฏุงุฆู ุจุงูููุงุฑุณุงุช ุงูุชุฑุจููุฉ ุงูุฏุงูุฌุฉ ููู ุงููุฑุฌุนูุงุช ุงููุบุฑุจูุฉ ุงูุฑุณููุฉ.
                </div>

                <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #3498db; margin: 25px 0;">
                    <h3 style="color: #2980b9; margin-bottom: 15px;">ุงููุฑุฌุนูุงุช ุงููุนุชูุฏุฉ:</h3>
                    <ul style="list-style-type: disc; padding-right: 20px; color: #555;">
                        <li>ุงูุฅุทุงุฑ ุงููุฑุฌุนู ููุชุฑุจูุฉ ุงูุฏุงูุฌุฉ ููุงุฆุฏุฉ ุงูุฃุทูุงู ูู ูุถุนูุฉ ุฅุนุงูุฉ โ ูุฒุงุฑุฉ ุงูุชุฑุจูุฉ ุงููุทููุฉ (2019)</li>
                        <li>ุฏููู ุงูุฃุณุชุงุฐ ููุชุฑุจูุฉ ุงูุฏุงูุฌุฉ</li>
                        <li>ุงููุฑุงุฑ ุงููุฒุงุฑู ุฑูู 047.19 ุจุดุฃู ุงูุชุฑุจูุฉ ุงูุฏุงูุฌุฉ ููุชูููุฐุงุช ูุงูุชูุงููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ</li>
                    </ul>
                </div>

                <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; margin: 25px 0;">
                    <h4 style="color: #27ae60; margin-bottom: 10px;">ูุง ุงููุทููุจ ูููู:</h4>
                    <p>โข ุชูููู 36 ุจูุฏ ููู ููุฌ ูุจุณุท ูุณุฑูุน</p>
                    <p>โข ููู ุจูุฏ: ุงุฎุชูุงุฑ (ููุงุณุจ / ูุญุชุงุฌ ุชุนุฏูู / ุบูุฑ ููุงุณุจ)</p>
                    <p>โข ุงูููุช ุงููุชููุน: 20-30 ุฏูููุฉ</p>
                    <p>โข ูุชู ุงูุญูุธ ุงูุชููุงุฆู ูู 30 ุซุงููุฉ</p>
                </div>

                <div class="navigation-buttons">
                    <div></div>
                    <button class="btn" onclick="nextPage()">ุงูุจุฏุก ูู ุงูุชุญููู</button>
                </div>
            </div>

            <!-- ุตูุญุฉ ุจูุงูุงุช ุงููุญูู -->
            <div class="page" id="page1">
                <div class="page-title">ุจูุงูุงุช ุงููุญูู</div>
                <div class="page-subtitle">ูุนูููุงุช ุนุงูุฉ ุชุณุงุนุฏ ูู ุชูุซูู ุนูููุฉ ุงูุชุญููู</div>

                <div class="form-group">
                    <label>ุงุณู ุงูููุญูููู *</label>
                    <input type="text" name="expert_name" placeholder="ุงูุงุณู ุงููุงูู">
                </div>

                <div class="form-group">
                    <label>ุงูุตูุฉ/ุงูุฏูุฑ *</label>
                    <select name="expert_role">
                        <option value="">ุงุฎุชุฑ...</option>
                        <option value="ุนุถู ููุฆุฉ ุชุฏุฑูุณ">ุนุถู ููุฆุฉ ุชุฏุฑูุณ</option>
                        <option value="ุจุงุญุซ">ุจุงุญุซ</option>
                        <option value="ูุดุฑู ุฃูุงุฏููู">ูุดุฑู ุฃูุงุฏููู</option>
                        <option value="ุฎุจูุฑ ููุฏุงูู">ุฎุจูุฑ ููุฏุงูู</option>
                        <option value="ููุชุด ุชุฑุจูู">ููุชุด ุชุฑุจูู</option>
                        <option value="ูุฏูุฑ ูุคุณุณุฉ ุชุนููููุฉ">ูุฏูุฑ ูุคุณุณุฉ ุชุนููููุฉ</option>
                        <option value="ุฃุฎุฑู">ุฃุฎุฑู</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ุณููุงุช ุงูุฎุจุฑุฉ *</label>
                    <input type="number" name="years_experience" min="0" max="60" placeholder="ุนุฏุฏ ุงูุณููุงุช">
                </div>

                <div class="form-group">
                    <label>ุทุจูุนุฉ ุงูุฎุจุฑุฉ ุจุงูุชุฑุจูุฉ ุงูุฏุงูุฌุฉ</label>
                    <select name="experience_type">
                        <option value="">ุงุฎุชุฑ...</option>
                        <option value="ุชุฏุฑูุณ">ุชุฏุฑูุณ</option>
                        <option value="ุจุญุซ">ุจุญุซ</option>
                        <option value="ุฅุฏุงุฑุฉ/ุชูููุฐ">ุฅุฏุงุฑุฉ/ุชูููุฐ</option>
                        <option value="ุชุฏุฑูุจ ูุนูููู">ุชุฏุฑูุจ ูุนูููู</option>
                        <option value="ุฃุฎุฑู">ุฃุฎุฑู</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (ุงุฎุชูุงุฑู)</label>
                    <input type="email" name="email" placeholder="your@email.com">
                </div>

                <div class="error-message" id="error1"></div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="prevPage()">ุงูุณุงุจู</button>
                    <button class="btn" onclick="nextPage()">ุงูุชุงูู</button>
                </div>
            </div>

            <!-- ุงููุญุงูุฑ ุณุชูุถุงู ููุง ุฏููุงููููุงู -->

            <!-- ุตูุญุฉ ุงูุชุนูููุงุช ุงูููุงุฆูุฉ -->
            <div class="page" id="final-page">
                <div class="page-title">ุชุนูููุงุช ููุงุฆูุฉ</div>

                <div class="form-group">
                    <label>ูู ุชูุฌุฏ ุจููุฏ ูููุฉ ููููุฏุฉ ุชูุชุฑุญูู ุฅุถุงูุชูุงุ</label>
                    <textarea name="missing_items" rows="4" placeholder="ุงุฐูุฑูุง ุงูุจููุฏ ุงููููุฉ ุงูุชู ุชุฑูู ุถุฑูุฑุฉ ุฅุถุงูุชูุง..."></textarea>
                </div>

                <div class="form-group">
                    <label>ุงูุชุฑุงุญุงุช ุฃุฎุฑู ูุชุญุณูู ุงูุงุณุชูุงุฑุฉ</label>
                    <textarea name="improvement_suggestions" rows="4" placeholder="ุฃู ุงูุชุฑุงุญุงุช ุฃุฎุฑู ูุชุทููุฑ ูุชุญุณูู ุงูุงุณุชูุงุฑุฉ..."></textarea>
                </div>

                <div style="background: #d4edda; border: 2px solid #c3e6cb; border-radius: 10px; padding: 20px; margin: 20px 0;">
                    <h4 style="color: #155724; margin-bottom: 10px;">๐ ุดูุฑุงู ุฌุฒููุงู ููู!</h4>
                    <p style="color: #155724; margin: 0;">
                        ูุณุงููุชูู ุงููููุฉ ุณุชุณุงุนุฏ ูู ุชุทููุฑ ุฃุฏุงุฉ ุจุญุซูุฉ ุนุงููุฉ ุงูุฌูุฏุฉ ุชุฎุฏู ุงูุชุฑุจูุฉ ุงูุฏุงูุฌุฉ ูู ุงููุบุฑุจ.
                    </p>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="prevPage()">ุงูุณุงุจู</button>
                    <button class="btn" onclick="submitForm()">ุฅุฑุณุงู ุงูุชุญููู ุงูููุงุฆู</button>
                </div>
            </div>

        </div>
    </div>

    <script>
        // ุฅุนุฏุงุฏุงุช ุฃุณุงุณูุฉ
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx1XY-zPav1TPCz6-0ItML-Cx7UXagf1TH1mIpvhPhAjm63txjVlEoVsT8wqxKyzCIhfg/exec';

        // ูุตูุต ุงูุจููุฏ ุงูู36
        const ITEMS = [
            "ุฃุฌุฑู ุชูููููุง ุชุดุฎูุตููุง ุฃููููุง ูุชุญุฏูุฏ ูุฏุฑุงุช ูุญุงุฌูุงุช ูู ุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ูุจู ุจุฏุก ุงูุชุฏุฑูุณ.",
            "ุฃุณุชุนูู ุฃุฏูุงุช ูุชุนุฏุฏุฉ (ููุงุจูุงุชุ ููุงุญุธุงุช ุตููุฉุ ุงุฎุชุจุงุฑุงุช ูุจุณุทุฉ) ูุฌูุน ูุนูููุงุช ุฏูููุฉ ุญูู ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ.",
            "ุฃุญุฏุฏ ูุณุชูู ุงูุฃุฏุงุก ุงูุญุงูู ููุชูููุฐ ูู ุงููุฌุงูุงุช ุงูุฃูุงุฏูููุฉุ ุงูุชูุงุตููุฉุ ุงูุงุฌุชูุงุนูุฉุ ูุงูุญุฑููุฉ.",
            "ุฃุทูุจ ุขุฑุงุก ุฃู ุชูุงุฑูุฑ ุงูุฃุฎุตุงุฆููู (ููุณูุ ูุทูุ ุนูุงุฌ ูุธููู) ูุงุณุชููุงู ุงูุชุดุฎูุต.",
            "ุฃูุนุฏ ุชูุฑูุฑูุง ุชุดุฎูุตููุง ููุชูุจูุง ูุชุถูู ุงูุญุงุฌุงุช ุงูุชุฑุจููุฉ ููุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ูุฃุถุนู ูู ูููู ุงููุฏุฑุณู.",
            "ุฃุดุงุฑู ูู ุฅุนุฏุงุฏ ุงููุดุฑูุน ุงูุจูุฏุงุบูุฌู ุงููุฑุฏู ููุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ุจุงูุชุนุงูู ูุน ุงููุฑูู ุงูุชุฑุจูู ูุงูุฃุณุฑุฉ.",
            "ุฃุญุฏุฏ ุฃูุฏุงููุง ุชุนููููุฉ ูุงูุนูุฉ ููุงุจูุฉ ููุชุญูู ุชุฑุงุนู ุฅููุงูุงุช ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ.",
            "ุฃููููู ูุญุชูู ุงูุฏุฑูุณ ูุงูุฃูุดุทุฉ ูุชูุงุฆู ุงููุดุฑูุน ุงูุจูุฏุงุบูุฌู ุงููุฑุฏู.",
            "ุฃุนุฏู ุฒูู ุงูุฃูุดุทุฉ ุจูุง ูุชูุงุณุจ ูุน ูุฏุฑุฉ ุงูุชูููุฐ ุนูู ุงูุชุฑููุฒ ูุงูุชุญูู.",
            "ุฃุทุจู ุงุณุชุฑุงุชูุฌูุงุช ุชุฏุฑูุณ ูุชููุนุฉ (ุงูุจูุฏุงุบูุฌูุง ุงููุงุฑููุฉุ ุงูุนูู ุงูุชุนุงูููุ ุงููุณุงุฆุท ุงูุจุตุฑูุฉ ูุงูุญุณูุฉ) ูุน ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ.",
            "ุฃุจุณุท ุงููุบุฉ ูุฃููู ุงูููุงู ุงููุนูุฏุฉุ ูู ุงููุญุณูุณ ุฅูู ุงููุฌุฑุฏุ ููุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ.",
            "ุฃุชุงุจุน ูุฏู ุชุญูู ุงูุฃูุฏุงู ูู ุงููุดุฑูุน ุงูุจูุฏุงุบูุฌู ุงููุฑุฏู ูุฃูุญุฏูุซ ุงูุฎุทุฉ ุนูุฏ ุงูุญุงุฌุฉ.",
            "ุฃุฏูุฌ ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ูู ุฃูุดุทุฉ ุฌูุงุนูุฉ ููุฐ ุงูุญุตุต ุงูุฃููู ูุชุนุฒูุฒ ุงูุชูุงุฆู.",
            "ุฃูููุฑ ุจูุฆุฉ ุตููุฉ ุขููุฉ ููุณููุง ูุงุฌุชูุงุนููุง ุชุญูุฒ ุงููุดุงุฑูุฉ ูุงููุจุงุฏุฑุฉ.",
            "ุฃููุฑ ูุฑุตูุง ููุชุธูุฉ ููุชูุงุนู ูุงูุชุนุงูู ุจูู ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ูุฒููุงุฆู.",
            "ุฃุทุจู ุฃุณุงููุจ ููุงุฆูุฉ ูุชุนุฒูุฒ ุงูุณููู ุงูุฅูุฌุงุจู ูุชูููู ุงูุณููููุงุช ุงูุตุนุจุฉ ูุฏู ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ.",
            "ุฃููุญ ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ุฃุฏูุงุฑูุง ููุณุคูููุงุช ููุงุณุจุฉ ููุฏุฑุงุชู.",
            "ุฃุญุชูู ุจุฅูุฌุงุฒุงุช ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ูุฃุนุฑุถูุง ูููุงุฐุฌ ุฅูุฌุงุจูุฉ ูุฒููุงุฆู.",
            "ุฃูุธู ูุถุงุก ุงููุณู ุจูุง ููุณุฑ ุงูุญุฑูุฉ ูุงููุตูู ุงูุขูู ููุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ.",
            "ุฃุณุชููุฏ ูู ูุงุนุฉ ุงูููุงุฑุฏ ูุชูุฏูู ุฏุนู ูุฑุฏู ุฃู ุฌูุงุนู ููุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ.",
            "ุฃูุธู ุงูุชูุงูุจ ุจูู ุฒูู ุงููุณู ูุฒูู ูุงุนุฉ ุงูููุงุฑุฏ ูุถูุงู ุงูุชูุงูู.",
            "ุฃููู ุงูุฅููุงุธ ุงูุฐููู ูุงูุงูุชุจุงู ูุงูุชุฑููุฒ ูุฏู ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ูู ุฎูุงู ุฃูุดุทุฉ ููุฌูุฉ.",
            "ุฃููู ุงูููุงุฑุงุช ุงูุญุฑููุฉ ุงูุฏูููุฉ ูุฏู ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ูู ุฎูุงู ุฃูุดุทุฉ ุนูููุฉ.",
            "ุฃุทูุฑ ุงูุฅุฏุฑุงู ุงูุจุตุฑู ูุงูุชูููุฒ ุงูุจุตุฑู-ุงูููุงูู ูุฏู ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ุนุจุฑ ุชุฏุฑูุจุงุช ููุฌูุฉ.",
            "ุฃููู ููุงุฑุงุช ุงูุชูุงุตู ูุฏู ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ุนุจุฑ ุฃูุดุทุฉ ุฌูุงุนูุฉ ุฃู ูุนุจ ููุฌู.",
            "ุฃุฏุฑูุจ ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ุนูู ููุงุฑุงุช ุญูุงุชูุฉ ุฃุณุงุณูุฉ ุชุนุฒุฒ ุงุณุชููุงููุชู.",
            "ุฃููููู ุฃุฏูุงุช ุงูุชูููู (ุดูููุ ุนูููุ ุฑููู) ูุชูุงุณุจ ุงุญุชูุงุฌุงุช ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ.",
            "ุฃุทุจู ุชููููุงุช ุงูุงูุชุญุงูุงุช ูุซู ุฅุนุทุงุก ููุช ุฅุถุงูู ุฃู ูุฑุงุกุฉ ุงูุฃุณุฆูุฉ ุดููููุง.",
            "ุฃููู ุชูุฏู ุงูุชูููุฐ ุจูุงุกู ุนูู ุฃูุฏุงูู ุงููุฑุฏูุฉ ูููุณ ุจุงูููุงุฑูุฉ ูุน ุฃูุฑุงูู.",
            "ุฃุณุชุฎุฏู ุงูุชูููู ุงูุชููููู ุงููุณุชูุฑ ูุชุนุฏูู ุทุฑุงุฆู ุงูุชุฏุฑูุณ ููุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ.",
            "ุฃุฌุฑู ุชููููุงุช ูุฑุญููุฉ ุฏูุฑูุฉ ูุชุญุฏูุซ ุงููุดุฑูุน ุงูุจูุฏุงุบูุฌู ุงููุฑุฏู ููุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ.",
            "ุฃูุซู ุชูุฏู ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ูู ููู ุฎุงุต ูุถู ูุชุงุฆุฌ ุงูุชูููู ูุงูููุงุญุธุงุช.",
            "ุฃุดุงุฑู ูุชุงุฆุฌ ุงููุชุงุจุนุฉ ูุน ุงูุฃุณุฑุฉ ูุงููุฑูู ุงูุชุฑุจูู ูุงูุทุจู.",
            "ุฃุณุชุฎุฏู ุณุฌูุงุช ุฒูููุฉ ูุฑุตุฏ ุฅูุฌุงุฒ ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ ุจุงููุณุจุฉ ููุฃูุฏุงู ุงููุญุฏุฏุฉ.",
            "ุฃูุฏู ููุชุฑุญุงุช ููุชูุจุฉ ูุชุนุฏูู ุงูุฃูุฏุงู ุฃู ุฅุญุงูุฉ ุงูุชูููุฐ ุนูู ุฎุฏูุงุช ุฏุนู ุฅุถุงููุฉ.",
            "ุฃุณุฌู ูู ุชูุงุฑูุฑ ุฏูุฑูุฉ ุฃุซุฑ ุงูุชุนุฏููุงุช ุนูู ุฃุฏุงุก ุงูุชูููุฐ ูู ูุถุนูุฉ ุฅุนุงูุฉ ุฐูููุฉ."
        ];

        let currentPage = 0;
        let totalPages = 0;
        let formData = {};

        // ุฅูุดุงุก ุตูุญุงุช ุงูุจููุฏ ุฏููุงููููุงู
        function createItemPages() {
            const content = document.querySelector('.content');
            const finalPage = document.getElementById('final-page');
            
            // ุฅูุดุงุก ุตูุญุงุช ุงูุจููุฏ (6 ุจููุฏ ููู ุตูุญุฉ)
            const itemsPerPage = 6;
            const pageCount = Math.ceil(ITEMS.length / itemsPerPage);
            
            for (let pageIndex = 0; pageIndex < pageCount; pageIndex++) {
                const startIndex = pageIndex * itemsPerPage;
                const endIndex = Math.min(startIndex + itemsPerPage, ITEMS.length);
                
                const pageDiv = document.createElement('div');
                pageDiv.className = 'page';
                pageDiv.id = `page${pageIndex + 2}`;
                
                const pageTitle = `ุงูุจููุฏ ${startIndex + 1} - ${endIndex}`;
                
                let pageHTML = `
                    <div class="page-title">${pageTitle}</div>
                    <div class="page-subtitle">
                        ูุฑุฌู ุชูููู ูู ุจูุฏ ุจุญุณุจ ููุงุณุจุชู ููุงุณุชูุงุฑุฉ
                    </div>
                `;
                
                for (let i = startIndex; i < endIndex; i++) {
                    const itemNumber = i + 1;
                    const itemText = ITEMS[i];
                    
                    pageHTML += `
                        <div class="item-card">
                            <div class="item-number">ุงูุจูุฏ ${itemNumber} ูู 36</div>
                            <div class="item-text">${itemText}</div>
                            
                            <div class="form-group">
                                <label>ุชููููู ููุฐุง ุงูุจูุฏ: *</label>
                                <div class="radio-group">
                                    <label>
                                        <input type="radio" name="item${itemNumber}_evaluation" value="ููุงุณุจ" onchange="handleItemEvaluation(${itemNumber}, 'ููุงุณุจ')">
                                        <span>ููุงุณุจ</span>
                                    </label>
                                    <label>
                                        <input type="radio" name="item${itemNumber}_evaluation" value="ูุญุชุงุฌ ุชุนุฏูู" onchange="handleItemEvaluation(${itemNumber}, 'ูุญุชุงุฌ ุชุนุฏูู')">
                                        <span>ูุญุชุงุฌ ุชุนุฏูู</span>
                                    </label>
                                    <label>
                                        <input type="radio" name="item${itemNumber}_evaluation" value="ุบูุฑ ููุงุณุจ" onchange="handleItemEvaluation(${itemNumber}, 'ุบูุฑ ููุงุณุจ')">
                                        <span>ุบูุฑ ููุงุณุจ</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="conditional-section" id="edit-section-${itemNumber}">
                                <label>ุงูุชุนุฏูู ุงูููุชุฑุญ: *</label>
                                <textarea name="item${itemNumber}_edit_suggestion" rows="3" placeholder="ุงูุชุฑุญ ุงูุชุนุฏูู ุงููุทููุจ..."></textarea>
                            </div>
                            
                            <div class="conditional-section" id="reject-section-${itemNumber}">
                                <label>ุณุจุจ ุนุฏู ุงูููุงุณุจุฉ: *</label>
                                <div class="checkbox-group">
                                    <label>
                                        <input type="checkbox" name="item${itemNumber}_reject_reason" value="ุบุงูุถ/ุบูุฑ ูุงุถุญ">
                                        <span>ุบุงูุถ/ุบูุฑ ูุงุถุญ</span>
                                    </label>
                                    <label>
                                        <input type="checkbox" name="item${itemNumber}_reject_reason" value="ุบูุฑ ููู/ุบูุฑ ูุฑุชุจุท">
                                        <span>ุบูุฑ ููู/ุบูุฑ ูุฑุชุจุท</span>
                                    </label>
                                    <label>
                                        <input type="checkbox" name="item${itemNumber}_reject_reason" value="ููุฑุฑ ูุน ุจูุฏ ุขุฎุฑ">
                                        <span>ููุฑุฑ ูุน ุจูุฏ ุขุฎุฑ</span>
                                    </label>
                                    <label>
                                        <input type="checkbox" name="item${itemNumber}_reject_reason" value="ุบูุฑ ูุงุจู ููุชุทุจูู">
                                        <span>ุบูุฑ ูุงุจู ููุชุทุจูู</span>
                                    </label>
                                    <label>
                                        <input type="checkbox" name="item${itemNumber}_reject_reason" value="ุฃุฎุฑู">
                                        <span>ุฃุฎุฑู</span>
                                    </label>
                                </div>
                                <textarea name="item${itemNumber}_reject_other" rows="2" placeholder="ุฃุณุจุงุจ ุฃุฎุฑู..." style="margin-top: 10px;"></textarea>
                            </div>
                        </div>
                    `;
                }
                
                pageHTML += `
                    <div class="error-message" id="error${pageIndex + 2}"></div>
                    <div class="navigation-buttons">
                        <button class="btn btn-secondary" onclick="prevPage()">ุงูุณุงุจู</button>
                        <button class="btn" onclick="nextPage()">ุงูุชุงูู</button>
                    </div>
                `;
                
                pageDiv.innerHTML = pageHTML;
                content.insertBefore(pageDiv, finalPage);
            }
            
            // ุชุญุฏูุซ ุงูุนุฏุฏ ุงูุฅุฌูุงูู ููุตูุญุงุช
            totalPages = document.querySelectorAll('.page').length;
        }

        // ุงูุชุนุงูู ูุน ุงูุชูููู ุงูุชุฏุฑูุฌู
        function handleItemEvaluation(itemNumber, value) {
            const editSection = document.getElementById(`edit-section-${itemNumber}`);
            const rejectSection = document.getElementById(`reject-section-${itemNumber}`);
            
            // ุฅุฎูุงุก ุฌููุน ุงูุฃูุณุงู ุฃููุงู
            editSection.classList.remove('show');
            rejectSection.classList.remove('show');
            
            // ุฅุธูุงุฑ ุงููุณู ุงูููุงุณุจ
            if (value === 'ูุญุชุงุฌ ุชุนุฏูู') {
                editSection.classList.add('show');
            } else if (value === 'ุบูุฑ ููุงุณุจ') {
                rejectSection.classList.add('show');
            }
            
            // ุญูุธ ุงูุจูุงูุงุช
            saveCurrentPageData();
        }

        // ุงูุชููู ุจูู ุงูุตูุญุงุช
        function nextPage() {
            if (!validateCurrentPage()) {
                return;
            }
            
            saveCurrentPageData();
            
            if (currentPage < totalPages - 1) {
                document.querySelectorAll('.page')[currentPage].classList.remove('active');
                currentPage++;
                document.querySelectorAll('.page')[currentPage].classList.add('active');
                updateProgress();
                window.scrollTo(0, 0);
            }
        }

        function prevPage() {
            saveCurrentPageData();
            
            if (currentPage > 0) {
                document.querySelectorAll('.page')[currentPage].classList.remove('active');
                currentPage--;
                document.querySelectorAll('.page')[currentPage].classList.add('active');
                updateProgress();
                window.scrollTo(0, 0);
            }
        }

        // ุชุญุฏูุซ ุดุฑูุท ุงูุชูุฏู
        function updateProgress() {
            const progress = ((currentPage + 1) / totalPages) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ูู ุงูุตูุญุฉ ุงูุญุงููุฉ
        function validateCurrentPage() {
            const currentPageElement = document.querySelectorAll('.page')[currentPage];
            const errorElement = currentPageElement.querySelector('.error-message');
            
            // ุฅุฒุงูุฉ ุงูุฃุฎุทุงุก ุงูุณุงุจูุฉ
            clearErrors();
            
            let isValid = true;
            let errorMessage = '';
            
            if (currentPage === 1) {
                // ุงูุชุญูู ูู ุจูุงูุงุช ุงููุญูู
                const requiredFields = ['expert_name', 'expert_role', 'years_experience'];
                
                for (const fieldName of requiredFields) {
                    const field = currentPageElement.querySelector(`[name="${fieldName}"]`);
                    if (!field || !field.value.trim()) {
                        field?.classList.add('invalid');
                        isValid = false;
                        errorMessage = 'ูุฑุฌู ููุก ุฌููุน ุงูุญููู ุงููุทููุจุฉ *';
                    }
                }
            } else if (currentPage >= 2 && currentPage < totalPages - 1) {
                // ุงูุชุญูู ูู ุชูููู ุงูุจููุฏ
                const itemCards = currentPageElement.querySelectorAll('.item-card');
                
                itemCards.forEach((card, index) => {
                    const itemNumber = ((currentPage - 2) * 6) + index + 1;
                    const evaluationRadios = card.querySelectorAll(`input[name="item${itemNumber}_evaluation"]`);
                    const isEvaluated = Array.from(evaluationRadios).some(radio => radio.checked);
                    
                    if (!isEvaluated) {
                        card.classList.add('invalid');
                        isValid = false;
                        errorMessage = 'ูุฑุฌู ุชูููู ุฌููุน ุงูุจููุฏ ูู ูุฐู ุงูุตูุญุฉ';
                    } else {
                        // ุงูุชุญูู ูู ุงูุญููู ุงูุดุฑุทูุฉ
                        const evaluationValue = card.querySelector(`input[name="item${itemNumber}_evaluation"]:checked`)?.value;
                        
                        if (evaluationValue === 'ูุญุชุงุฌ ุชุนุฏูู') {
                            const editTextarea = card.querySelector(`textarea[name="item${itemNumber}_edit_suggestion"]`);
                            if (!editTextarea?.value.trim()) {
                                editTextarea?.classList.add('invalid');
                                isValid = false;
                                errorMessage = 'ูุฑุฌู ูุชุงุจุฉ ุงูุชุนุฏูู ุงูููุชุฑุญ ููุจููุฏ ุงูุชู ุชุญุชุงุฌ ุชุนุฏูู';
                            }
                        } else if (evaluationValue === 'ุบูุฑ ููุงุณุจ') {
                            const rejectCheckboxes = card.querySelectorAll(`input[name="item${itemNumber}_reject_reason"]`);
                            const isReasonSelected = Array.from(rejectCheckboxes).some(checkbox => checkbox.checked);
                            
                            if (!isReasonSelected) {
                                card.querySelector('.checkbox-group')?.classList.add('invalid');
                                isValid = false;
                                errorMessage = 'ูุฑุฌู ุชุญุฏูุฏ ุณุจุจ ุนุฏู ููุงุณุจุฉ ุงูุจูุฏ';
                            }
                        }
                    }
                });
            }
            
            if (!isValid && errorElement) {
                errorElement.textContent = errorMessage;
                errorElement.style.display = 'block';
            }
            
            return isValid;
        }

        // ุฅุฒุงูุฉ ุฃุฎุทุงุก ุงูุชุญูู
        function clearErrors() {
            document.querySelectorAll('.invalid').forEach(element => {
                element.classList.remove('invalid');
            });
            document.querySelectorAll('.error-message').forEach(element => {
                element.style.display = 'none';
            });
        }

        // ุญูุธ ุจูุงูุงุช ุงูุตูุญุฉ ุงูุญุงููุฉ
        function saveCurrentPageData() {
            const currentPageElement = document.querySelectorAll('.page')[currentPage];
            const inputs = currentPageElement.querySelectorAll('input, textarea, select');
            
            inputs.forEach(input => {
                if (input.type === 'radio') {
                    if (input.checked) {
                        formData[input.name] = input.value;
                    }
                } else if (input.type === 'checkbox') {
                    if (!formData[input.name]) {
                        formData[input.name] = [];
                    }
                    if (input.checked && !formData[input.name].includes(input.value)) {
                        formData[input.name].push(input.value);
                    } else if (!input.checked) {
                        formData[input.name] = formData[input.name].filter(val => val !== input.value);
                    }
                } else {
                    formData[input.name] = input.value;
                }
            });
            
            // ุญูุธ ูู ุงูุชุฎุฒูู ุงููุญูู
            try {
                localStorage.setItem('evaluationFormData', JSON.stringify(formData));
            } catch (e) {
                console.log('Could not save to localStorage');
            }
        }

        // ุชุญููู ุงูุจูุงูุงุช ุงููุญููุธุฉ
        function loadSavedData() {
            try {
                const savedData = localStorage.getItem('evaluationFormData');
                if (savedData) {
                    formData = JSON.parse(savedData);
                    restoreFormData();
                }
            } catch (e) {
                console.log('Could not load from localStorage');
            }
        }

        // ุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ูู ุงููููุฐุฌ
        function restoreFormData() {
            Object.keys(formData).forEach(name => {
                const elements = document.querySelectorAll(`[name="${name}"]`);
                elements.forEach(element => {
                    if (element.type === 'radio') {
                        if (element.value === formData[name]) {
                            element.checked = true;
                            // ุชุญุฏูุซ ุงูุฃูุณุงู ุงูุดุฑุทูุฉ
                            if (name.includes('_evaluation')) {
                                const itemNumber = name.match(/item(\d+)_evaluation/)?.[1];
                                if (itemNumber) {
                                    handleItemEvaluation(parseInt(itemNumber), element.value);
                                }
                            }
                        }
                    } else if (element.type === 'checkbox') {
                        if (Array.isArray(formData[name]) && formData[name].includes(element.value)) {
                            element.checked = true;
                        }
                    } else {
                        element.value = formData[name] || '';
                    }
                });
            });
        }

        // ุงูุญูุธ ุงูุชููุงุฆู
        function setupAutoSave() {
            setInterval(() => {
                saveCurrentPageData();
            }, 30000); // ูู 30 ุซุงููุฉ
        }

        // ุฅุฑุณุงู ุงููููุฐุฌ ุงูููุงุฆู
        async function submitForm() {
            if (!validateCurrentPage()) {
                return;
            }
            
            saveCurrentPageData();
            
            // ุชุฃููุฏ ุงูุฅุฑุณุงู
            if (!confirm('ูู ุฃูุชู ูุชุฃูุฏูู ูู ุฅุฑุณุงู ุงูุชุญูููุ ูู ุชุชููููุง ูู ุงูุชุนุฏูู ุจุนุฏ ุงูุฅุฑุณุงู.')) {
                return;
            }
            
            try {
                // ุชุญุถูุฑ ุงูุจูุงูุงุช ููุฅุฑุณุงู
                const formDataToSend = new FormData();
                
                // ุฅุถุงูุฉ ุงูุทุงุจุน ุงูุฒููู
                formDataToSend.append('timestamp', new Date().toISOString());
                
                // ุฅุถุงูุฉ ุจูุงูุงุช ุงููุญูู
                formDataToSend.append('ุงุณู ุงูููุญูููู', formData.expert_name || '');
                formDataToSend.append('ุงูุตูุฉ/ุงูุฏูุฑ', formData.expert_role || '');
                formDataToSend.append('ุณููุงุช ุงูุฎุจุฑุฉ', formData.years_experience || '');
                formDataToSend.append('ุทุจูุนุฉ ุงูุฎุจุฑุฉ ุจุงูุชุฑุจูุฉ ุงูุฏุงูุฌุฉ', formData.experience_type || '');
                formDataToSend.append('ุงูุจุฑูุฏ ุงูุฅููุชุฑููู', formData.email || '');
                
                // ุฅุถุงูุฉ ุจูุงูุงุช ุงูุจููุฏ
                for (let i = 1; i <= 36; i++) {
                    formDataToSend.append(`ุงูุจูุฏ ${i} - ุชูููู`, formData[`item${i}_evaluation`] || '');
                    formDataToSend.append(`ุงูุจูุฏ ${i} - ุชุนุฏูู ููุชุฑุญ`, formData[`item${i}_edit_suggestion`] || '');
                    
                    // ุฃุณุจุงุจ ุงูุฑูุถ (ุชุญููู ุงููุตูููุฉ ุฅูู ูุต)
                    const rejectReasons = formData[`item${i}_reject_reason`];
                    if (Array.isArray(rejectReasons)) {
                        formDataToSend.append(`ุงูุจูุฏ ${i} - ุณุจุจ ุงูุฑูุถ`, rejectReasons.join(', '));
                    } else {
                        formDataToSend.append(`ุงูุจูุฏ ${i} - ุณุจุจ ุงูุฑูุถ`, '');
                    }
                }
                
                // ุฅุถุงูุฉ ุงูุชุนูููุงุช ุงูููุงุฆูุฉ
                formDataToSend.append('ุจููุฏ ููููุฏุฉ ููุชุฑุญุฉ', formData.missing_items || '');
                formDataToSend.append('ุงูุชุฑุงุญุงุช ุชุญุณูู ุงูุงุณุชูุงุฑุฉ', formData.improvement_suggestions || '');
                
                // ุฅุฑุณุงู ุงูุจูุงูุงุช
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: formDataToSend
                });
                
                if (response.ok) {
                    // ุนุฑุถ ุฑุณุงูุฉ ุงููุฌุงุญ
                    document.querySelector('.content').innerHTML = `
                        <div style="text-align: center; padding: 50px;">
                            <div style="font-size: 4em; color: #27ae60; margin-bottom: 20px;">โ</div>
                            <h2 style="color: #27ae60; margin-bottom: 15px;">ุชู ุฅุฑุณุงู ุงูุชุญููู ุจูุฌุงุญ!</h2>
                            <p style="color: #555; font-size: 1.1em; line-height: 1.6;">
                                ุดูุฑุงู ุฌุฒููุงู ููุณุงููุชูู ุงููููุฉ!<br>
                                ุชู ุญูุธ ุชูููููู ูุณูุณุงูู ูู ุชุทููุฑ ุฃุฏุงุฉ ุจุญุซูุฉ ุนุงููุฉ ุงูุฌูุฏุฉ.
                            </p>
                            <div style="background: #e3f2fd; border: 2px solid #2196f3; border-radius: 10px; padding: 20px; margin: 20px 0;">
                                <p style="color: #1976d2; margin: 0;">
                                    <strong>๐ก ููุงุญุธุฉ:</strong> ูููููู ุฅุบูุงู ูุฐู ุงููุงูุฐุฉ ุงูุขู.
                                </p>
                            </div>
                        </div>
                    `;
                    
                    // ุญุฐู ุงูุจูุงูุงุช ุงููุญููุธุฉ
                    localStorage.removeItem('evaluationFormData');
                } else {
                    throw new Error('ูุดู ูู ุงูุฅุฑุณุงู');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('ุญุฏุซ ุฎุทุฃ ูู ุงูุฅุฑุณุงู. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ุฃู ุงูุชูุงุตู ูุน ุงูุจุงุญุซ.');
            }
        }

        // ุชููุฆุฉ ุงูุตูุญุฉ
        function initializePage() {
            createItemPages();
            updateProgress();
            loadSavedData();
            setupAutoSave();
            
            // ุฅุถุงูุฉ ูุณุชูุน ูุญูุธ ุงูุจูุงูุงุช ุนูุฏ ูุบุงุฏุฑุฉ ุงูุตูุญุฉ
            window.addEventListener('beforeunload', function() {
                saveCurrentPageData();
            });
            
            // ุชุญุฐูุฑ ูู ููุฏุงู ุงูุจูุงูุงุช
            window.addEventListener('beforeunload', function(e) {
                if (currentPage > 0 && Object.keys(formData).length > 0) {
                    e.preventDefault();
                    e.returnValue = 'ุณูุชู ููุฏุงู ุงูุจูุงูุงุช ุบูุฑ ุงููุญููุธุฉ. ูู ุชุฑูุฏ ุงููุบุงุฏุฑุฉุ';
                }
            });
        }

        // ุชุดุบูู ุงูุชููุฆุฉ ุนูุฏ ุชุญููู ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', initializePage);
    </script>
</body>
</html>
