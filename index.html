<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„ØªØ­ÙƒÙŠÙ… â€“ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</title>
  <style>
    body { font-family: system-ui,"Segoe UI",Tahoma,Arial; line-height:1.7; margin:0; background:#fafafa; color:#222; }
    .container { max-width:1000px; margin:24px auto; background:#fff; padding:24px; border-radius:16px; box-shadow:0 6px 24px rgba(0,0,0,.06); }
    h1,h2 { margin-top:0; }
    .toolbar { display:flex; gap:8px; flex-wrap:wrap; margin:8px 0 16px; }
    .page { display:none; }
    .page.active { display:block; }
    .navigation-buttons { display:flex; gap:12px; margin-top:20px; }
    .btn { padding:10px 16px; border:none; border-radius:10px; cursor:pointer; background:#1a73e8; color:#fff; font-weight:600; }
    .btn-secondary { background:#737373; }
    .btn-ghost { background:#eef2ff; color:#1e3a8a; }
    .btn-danger { background:#e11d48; }
    .btn:disabled { opacity:.5; cursor:not-allowed; }
    .progress { background:#eee; height:10px; border-radius:999px; overflow:hidden; margin:16px 0 24px; }
    .progress > span { display:block; height:100%; width:0%; background:#1a73e8; transition:width .3s; }
    .field { margin:12px 0; }
    label { display:block; margin-bottom:6px; font-weight:600; }
    input[type="text"],input[type="number"],input[type="email"],textarea,select { width:100%; padding:10px; border-radius:10px; border:1px solid #ddd; }
    .hint { color:#666; font-size:.9em; }
    .grid { display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:16px; }
    .grid .field:nth-child(4) { grid-column: span 3; }
    .item-block hr { border:none; border-top:1px dashed #ddd; margin:16px 0; }
    @media (max-width: 900px) {
      .grid { grid-template-columns: 1fr; }
      .grid .field:nth-child(4) { grid-column: span 1; }
    }

    /* Ø¥Ø¨Ø±Ø§Ø² Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ø§Ù‚ØµØ© */
    .field.invalid { border:1px solid #e11d48 !important; background:#fff1f2; padding:10px; border-radius:10px; }
    .field.invalid label::after { content:" * Ù…Ø·Ù„ÙˆØ¨"; color:#e11d48; margin-right:6px; font-weight:700; }

    /* Ø´Ø§Ø±Ø© ØªÙˆØ¶ÙŠØ­ÙŠØ© Ø£Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠ */
    .overall-note { background:#f1f5ff; border:1px dashed #93c5fd; padding:8px 12px; border-radius:10px; font-size:.95em; color:#1e3a8a; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„ØªØ­ÙƒÙŠÙ… â€“ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</h1>

    <!-- Ø´Ø±ÙŠØ· Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ù„ÙŠ -->
    <div class="toolbar">
      <button class="btn btn-ghost" type="button" onclick="saveToLocal()">ğŸ’¾ Ø­ÙØ¸ Ù…Ø­Ù„ÙŠÙ‹Ø§</button>
      <button class="btn btn-ghost" type="button" onclick="loadFromLocal()">âŸ³ Ø§Ø³ØªØ±Ø¬Ø§Ø¹</button>
      <button class="btn btn-danger" type="button" onclick="clearAll()">âœ• ØªÙØ±ÙŠØº Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>

    <div class="progress"><span id="progressFill"></span></div>

    <div id="pages">
      <!-- Ø§Ù„ØµÙØ­Ø© 0: ØªØ±Ø­ÙŠØ¨ -->
      <section class="page active" id="page0">
        <h2>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ</h2>
        <p>Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù…Ù† Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„ØªØ­ÙƒÙŠÙ…. Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„.</p>
        <div class="navigation-buttons">
          <button class="btn" type="button" onclick="nextPage()">Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­ÙƒÙŠÙ…</button>
        </div>
      </section>

      <!-- Ø§Ù„ØµÙØ­Ø© 1: Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø§Ù…Ø© -->
      <section class="page" id="page1">
        <h2>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙƒÙ‘Ù…</h2>
        <div class="grid">
          <div class="field">
            <label>Ø§Ø³Ù… Ø§Ù„Ù…ÙØ­ÙƒÙ‘ÙÙ…</label>
            <input type="text" name="Ø§Ø³Ù… Ø§Ù„Ù…ÙØ­ÙƒÙ‘ÙÙ…" placeholder="Ù…Ø«Ø§Ù„: Ø¯. Ø£Ø­Ù…Ø¯" />
          </div>
          <div class="field">
            <label>Ø§Ù„ØµÙØ©/Ø§Ù„Ø¯ÙˆØ±</label>
            <select name="Ø§Ù„ØµÙØ©/Ø§Ù„Ø¯ÙˆØ±">
              <option value="">Ø§Ø®ØªØ±...</option>
              <option value="Ø¹Ø¶Ùˆ Ù‡ÙŠØ¦Ø© ØªØ¯Ø±ÙŠØ³">Ø¹Ø¶Ùˆ Ù‡ÙŠØ¦Ø© ØªØ¯Ø±ÙŠØ³</option>
              <option value="Ø¨Ø§Ø­Ø«">Ø¨Ø§Ø­Ø«</option>
              <option value="Ù…Ø´Ø±Ù Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ">Ù…Ø´Ø±Ù Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ</option>
              <option value="Ø®Ø¨ÙŠØ± Ù…ÙŠØ¯Ø§Ù†ÙŠ">Ø®Ø¨ÙŠØ± Ù…ÙŠØ¯Ø§Ù†ÙŠ</option>
            </select>
          </div>
          <div class="field">
            <label>Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©</label>
            <input type="number" name="Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©" min="0" max="60" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ù†ÙˆØ§Øª" />
          </div>
          <div class="field">
            <label>Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„Ø®Ø¨Ø±Ø© Ø¨Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¯Ø§Ù…Ø¬Ø©</label>
            <select name="Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„Ø®Ø¨Ø±Ø© Ø¨Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¯Ø§Ù…Ø¬Ø©">
              <option value="">Ø§Ø®ØªØ±...</option>
              <option value="ØªØ¯Ø±ÙŠØ³">ØªØ¯Ø±ÙŠØ³</option>
              <option value="Ø¨Ø­Ø«">Ø¨Ø­Ø«</option>
              <option value="Ø¥Ø¯Ø§Ø±Ø©/ØªÙ†ÙÙŠØ°">Ø¥Ø¯Ø§Ø±Ø©/ØªÙ†ÙÙŠØ°</option>
              <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
            </select>
          </div>
          <div class="field">
            <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <input type="email" name="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" />
          </div>
        </div>

        <div class="navigation-buttons">
          <button class="btn btn-secondary" type="button" onclick="prevPage()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
          <button class="btn" type="button" onclick="nextPage()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </div>
      </section>
      <!-- Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¨Ù†ÙˆØ¯ÙŠØ© Ø³ØªÙÙˆÙ„Ù‘ÙØ¯ Ø¨Ø±Ù…Ø¬ÙŠÙ‹Ø§ -->
    </div>

    <!-- ØµÙØ­Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ… -->
    <section class="page" id="page999">
      <h2>ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¹Ø§Ù…Ø© ÙˆØªÙ‚ÙŠÙŠÙ… Ù†Ù‡Ø§Ø¦ÙŠ</h2>

      <div class="overall-note" id="overallBadge">Ø³ÙŠÙØ­Ø³Ø¨ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ù…ØªÙˆØ³Ø· Ø¯Ø±Ø¬Ø§Øª (ÙˆØ¶ÙˆØ­/Ù…Ù„Ø§Ø¡Ù…Ø©/Ø´Ù…ÙˆÙ„ÙŠØ©) Ù„ÙƒÙ„ Ø§Ù„Ø¨Ù†ÙˆØ¯.</div>
      <br>

      <div class="grid">
        <div class="field">
          <label>ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆØ± 1</label>
          <textarea name="ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆØ± 1" rows="3"></textarea>
        </div>
        <div class="field">
          <label>ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆØ± 3</label>
          <textarea name="ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆØ± 3" rows="3"></textarea>
        </div>
        <div class="field">
          <label>ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆØ± 4</label>
          <textarea name="ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆØ± 4" rows="3"></textarea>
        </div>
        <div class="field">
          <label>ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆØ± 5</label>
          <textarea name="ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆØ± 5" rows="3"></textarea>
        </div>
        <div class="field">
          <label>ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆØ± 6</label>
          <textarea name="ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆØ± 6" rows="3"></textarea>
        </div>

        <div class="field">
          <label>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠ</label>
          <select name="Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠ" id="overallSelect">
            <option value="">Ø§Ø®ØªØ±...</option>
            <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
          </select>
        </div>
        <div class="field">
          <label>Ø´Ù…ÙˆÙ„ Ø§Ù„ØªØºØ·ÙŠØ©</label>
          <select name="Ø´Ù…ÙˆÙ„ Ø§Ù„ØªØºØ·ÙŠØ©">
            <option value="">Ø§Ø®ØªØ±...</option>
            <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
          </select>
        </div>
        <div class="field">
          <label>Ù…Ù„Ø§Ø¡Ù…Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯</label>
          <select name="Ù…Ù„Ø§Ø¡Ù…Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯">
            <option value="">Ø§Ø®ØªØ±...</option>
            <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
          </select>
        </div>
        <div class="field">
          <label>Ø§Ù„ØªÙˆØµÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</label>
          <select name="Ø§Ù„ØªÙˆØµÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©">
            <option value="">Ø§Ø®ØªØ±...</option>
            <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
            <option value="Ø¨Ø¹Ø¯ ØªØ¹Ø¯ÙŠÙ„Ø§Øª">Ø¨Ø¹Ø¯ ØªØ¹Ø¯ÙŠÙ„Ø§Øª</option>
            <option value="Ù„Ø§">Ù„Ø§</option>
          </select>
        </div>

        <div class="field" style="grid-column:1/-1">
          <label>Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚ÙˆØ©</label>
          <textarea name="Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚ÙˆØ©" rows="3"></textarea>
        </div>
        <div class="field" style="grid-column:1/-1">
          <label>Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†</label>
          <textarea name="Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†" rows="3"></textarea>
        </div>
        <div class="field" style="grid-column:1/-1">
          <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ø§Ù…Ø©</label>
          <textarea name="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ø§Ù…Ø©" rows="3"></textarea>
        </div>
      </div>

      <div class="navigation-buttons">
        <button class="btn btn-secondary" type="button" onclick="prevPage()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
        <button class="btn" type="button" onclick="nextPage()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
      </div>
    </section>

    <!-- ØµÙØ­Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ -->
    <section class="page" id="page1000">
      <h2>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ­ÙƒÙŠÙ…</h2>
      <p class="hint">Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ­ÙƒÙŠÙ…" Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Google Sheet.</p>
      <div class="navigation-buttons">
        <button class="btn btn-secondary" type="button" onclick="prevPage()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
        <button class="btn" type="button" onclick="submitForm()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ­ÙƒÙŠÙ…</button>
      </div>
    </section>

  </div>

  <script>
    // ========= Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª =========
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzCQrG9O7EeWSqtjNludnMP8rukeeKqqVSY8aAKZRb_ZfuaSTc_LDWlDspGniPOQvN1zA/exec';
    const STORAGE_KEY = 'evaluationFormData';

    // Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨Ù†ÙˆØ¯ 1â€“6 Ø«Ù… 13â€“36 (Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù†Ø³Ø®ØªÙƒ Ø§Ù„Ø£ØµÙ„ÙŠØ©).
    const ITEM_NUMBERS = [1,2,3,4,5,6, 13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36];

    // ========= Ø¥Ù†Ø´Ø§Ø¡ ØµÙØ­Ø§Øª Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ (6 Ø¨Ù†ÙˆØ¯ ÙÙŠ Ø§Ù„ØµÙØ­Ø©) =========
    function createItemBlock(n) {
      return `
        <div class="item-block">
          <h3>Ø§Ù„Ø¨Ù†Ø¯ ${n}</h3>
          <p class="hint"><em>Ø¶Ø¹ Ù†Øµ Ø§Ù„Ø¨Ù†Ø¯ Ù‡Ù†Ø§ Ù„Ùˆ Ø±ØºØ¨Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</em></p>

          <div class="grid">
            <div class="field">
              <label>Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ ÙˆØ¶ÙˆØ­</label>
              <div>
                ${[1,2,3,4,5].map(i => `<label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ ÙˆØ¶ÙˆØ­" value="${i}"> ${i}</label>`).join(' ')}
              </div>
            </div>

            <div class="field">
              <label>Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù…Ù„Ø§Ø¡Ù…Ø©</label>
              <div>
                ${[1,2,3,4,5].map(i => `<label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù…Ù„Ø§Ø¡Ù…Ø©" value="${i}"> ${i}</label>`).join(' ')}
              </div>
            </div>

            <div class="field">
              <label>Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ø´Ù…ÙˆÙ„ÙŠØ©</label>
              <div>
                ${[1,2,3,4,5].map(i => `<label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ø´Ù…ÙˆÙ„ÙŠØ©" value="${i}"> ${i}</label>`).join(' ')}
              </div>
            </div>

            <div class="field">
              <label>Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù‚Ø±Ø§Ø±</label>
              <div>
                <label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù‚Ø±Ø§Ø±" value="Ù…Ù†Ø§Ø³Ø¨"> Ù…Ù†Ø§Ø³Ø¨</label>
                <label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù‚Ø±Ø§Ø±" value="ÙŠØ­ØªØ§Ø¬ ØªØ¹Ø¯ÙŠÙ„"> ÙŠØ­ØªØ§Ø¬ ØªØ¹Ø¯ÙŠÙ„</label>
                <label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù‚Ø±Ø§Ø±" value="ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨"> ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨</label>
              </div>
            </div>
          </div>

          <div class="field">
            <label>Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
            <textarea name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª" rows="3" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ø®ØªØµØ±Ø©"></textarea>
          </div>

          <hr />
        </div>
      `;
    }

    function createItemPages() {
      const chunkSize = 6;
      const pagesWrap = document.getElementById('pages');
      let pageIndex = 2; // Ù„Ø¯ÙŠÙ†Ø§ page0, page1 Ù…Ø³Ø¨Ù‚Ù‹Ø§

      for (let i = 0; i < ITEM_NUMBERS.length; i += chunkSize) {
        const chunk = ITEM_NUMBERS.slice(i, i + chunkSize);
        const blocks = chunk.map(n => createItemBlock(n)).join('');
        const sec = document.createElement('section');
        sec.className = 'page';
        sec.id = 'page' + pageIndex;
        sec.innerHTML = `
          <h2>Ù…Ø­Ø§ÙˆØ± Ø§Ù„Ø¨Ù†ÙˆØ¯ (${chunk[0]}â€“${chunk[chunk.length - 1]})</h2>
          ${blocks}
          <div class="navigation-buttons">
            <button class="btn btn-secondary" type="button" onclick="prevPage()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
            <button class="btn" type="button" onclick="nextPage()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
          </div>
        `;
        pagesWrap.appendChild(sec);
        pageIndex++;
      }
    }

    // ========= Ø­Ø§Ù„Ø© ÙˆÙ†Ù‚Ù„ Ø§Ù„ØµÙØ­Ø§Øª =========
    window.formData = {};
    let pages = [];
    let currentPage = 0;

    function refreshPages() {
      pages = Array.from(document.querySelectorAll('.page'));
      updateProgress();
    }

    function updateProgress() {
      const fill = document.getElementById('progressFill');
      const progress = ((currentPage + 1) / pages.length) * 100;
      fill.style.width = progress + '%';
    }

    function goTo(i) {
      if (i < 0 || i >= pages.length) return;
      pages[currentPage].classList.remove('active');
      currentPage = i;
      pages[currentPage].classList.add('active');
      updateProgress();
      window.scrollTo(0,0);

      // Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„ Ù„ØµÙØ­Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØŒ Ø§Ø­Ø³Ø¨ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
      const id = pages[currentPage]?.id || '';
      if (id === 'page999') {
        computeOverallScore();
      }
    }

    function nextPage() { saveCurrentPageData(); goTo(currentPage + 1); }
    function prevPage() { saveCurrentPageData(); goTo(currentPage - 1); }

    // ========= Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© =========
    function saveCurrentPageData() {
      const el = pages[currentPage];
      const inputs = el.querySelectorAll('input, textarea, select');
      const pageData = {};

      inputs.forEach(input => {
        const name = input.name;
        if (!name) return;
        const type = (input.type || '').toLowerCase();
        if (type === 'checkbox') {
          if (!pageData[name]) pageData[name] = [];
          if (input.checked) pageData[name].push(input.value);
        } else if (type === 'radio') {
          if (input.checked) pageData[name] = input.value;
        } else {
          pageData[name] = input.value || '';
        }
      });

      Object.assign(window.formData, pageData);
      try { localStorage.setItem(STORAGE_KEY, JSON.stringify(window.formData)); } catch(e) {}
    }

    // ========= Helpers Ù„ÙØ­Øµ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ =========
    function clearInvalids() {
      document.querySelectorAll('.field.invalid').forEach(el => el.classList.remove('invalid'));
    }

    function markInvalidFieldByInput(inputEl) {
      const field = inputEl?.closest('.field') || inputEl?.parentElement;
      if (field) field.classList.add('invalid');
      return field;
    }

    function markInvalidRadioGroupByName(name) {
      const radios = document.querySelectorAll(`input[type="radio"][name="${name}"]`);
      if (!radios.length) return null;
      const anyChecked = Array.from(radios).some(r => r.checked);
      if (anyChecked) return null;
      const field = radios[0].closest('.field') || radios[0].parentElement;
      if (field) field.classList.add('invalid');
      return field;
    }

    function pageIndexOfElement(el) {
      const sec = el?.closest('.page');
      return sec ? pages.indexOf(sec) : -1;
    }

    // ========= Ø§Ù„ØªØ­Ù‚Ù‘Ù‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ =========
    function validateForm() {
      clearInvalids();
      let firstInvalidField = null;
      let firstInvalidPageIdx = -1;

      // Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
      const requiredSingles = [
        'Ø§Ø³Ù… Ø§Ù„Ù…ÙØ­ÙƒÙ‘ÙÙ…',
        'Ø§Ù„ØµÙØ©/Ø§Ù„Ø¯ÙˆØ±',
        'Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©',
        'Ø§Ù„ØªÙˆØµÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©'
      ];

      for (const name of requiredSingles) {
        const el = document.querySelector(`[name="${name}"]`);
        if (!el) continue;
        let ok = true;

        if (el.tagName === 'SELECT' || el.type === 'text' || el.type === 'email' || el.type === 'number') {
          const val = (el.value || '').trim();
          ok = val !== '';
          if (name === 'Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©') {
            const n = Number(val);
            ok = ok && !Number.isNaN(n) && n >= 0 && n <= 60;
          }
        }

        if (!ok) {
          const field = markInvalidFieldByInput(el);
          if (!firstInvalidField) {
            firstInvalidField = field || el;
            firstInvalidPageIdx = pageIndexOfElement(firstInvalidField);
          }
        }
      }

      // Ù‚Ø±Ø§Ø± Ù„ÙƒÙ„ Ø¨Ù†Ø¯ (ITEM_NUMBERS)
      for (const n of ITEM_NUMBERS) {
        const field = markInvalidRadioGroupByName(`Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù‚Ø±Ø§Ø±`);
        if (field && !firstInvalidField) {
          firstInvalidField = field;
          firstInvalidPageIdx = pageIndexOfElement(field);
        }
      }

      // Ù„Ùˆ ÙŠÙˆØ¬Ø¯ Ù†Ù‚ØµØŒ Ù†Ù†ØªÙ‚Ù„ Ù„Ø£ÙˆÙ„ ØµÙØ­Ø© ÙÙŠÙ‡Ø§ Ø®Ø·Ø£
      if (firstInvalidField) {
        if (firstInvalidPageIdx >= 0 && firstInvalidPageIdx !== currentPage) {
          goTo(firstInvalidPageIdx);
          setTimeout(() => firstInvalidField.scrollIntoView({behavior:'smooth', block:'center'}), 200);
        } else {
          firstInvalidField.scrollIntoView({behavior:'smooth', block:'center'});
        }
        alert('Ø±Ø¬Ø§Ø¡Ù‹ Ø§Ø³ØªÙƒÙ…Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø§Ù„Ù…Ø¹Ù„Ù‘Ù…Ø© Ø¨Ø§Ù„Ø£Ø­Ù…Ø±.');
        return false;
      }
      return true;
    }

    // ========= Ø­ÙØ³Ø¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠ =========
    function computeOverallScore() {
      // ØªØ£ÙƒØ¯ Ø£Ù† Ø¢Ø®Ø± Ø¥Ø¯Ø®Ø§Ù„Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©
      saveCurrentPageData();

      const parts = ['ÙˆØ¶ÙˆØ­','Ù…Ù„Ø§Ø¡Ù…Ø©','Ø´Ù…ÙˆÙ„ÙŠØ©'];
      const values = [];

      for (const n of ITEM_NUMBERS) {
        for (const p of parts) {
          const key = `Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ ${p}`;
          const v = Number(window.formData[key]);
          if (!Number.isNaN(v)) values.push(v);
        }
      }

      const badge = document.getElementById('overallBadge');
      const select = document.getElementById('overallSelect');

      if (!values.length) {
        if (badge) badge.textContent = 'Ù„Ù… ØªÙØ¯Ø®ÙÙ„ Ø¯Ø±Ø¬Ø§Øª ÙƒØ§ÙÙŠØ© Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠ Ø¨Ø¹Ø¯.';
        if (select) select.value = '';
        return null;
      }

      const avg = values.reduce((a,b)=>a+b,0) / values.length;
      const rounded = Math.round(avg);

      if (select) select.value = String(rounded);
      if (badge) badge.textContent = `Ø§Ù„Ù…ØªÙˆØ³Ø· = ${avg.toFixed(2)}  â†’  ØªÙ… Ø¶Ø¨Ø· "Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠ" ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ ${rounded}`;

      return { avg, rounded, count: values.length };
    }

    // ========= Ø­ÙØ¸/Ø§Ø³ØªØ±Ø¬Ø§Ø¹/ØªÙØ±ÙŠØº Ù…Ø­Ù„ÙŠ =========
    function saveToLocal() {
      saveCurrentPageData();
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(window.formData));
        alert('ØªÙ… Ø§Ù„Ø­ÙØ¸ Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­.');
      } catch (e) {
        alert('ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ù„ÙŠ (Ù‚Ø¯ ØªÙƒÙˆÙ† Ù…Ø³Ø§Ø­Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ù…Ù…ØªÙ„Ø¦Ø©).');
      }
    }

    function loadFromLocal() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) { alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠÙ‹Ø§.'); return; }
        const data = JSON.parse(raw);
        if (!data || typeof data !== 'object') { alert('Ù…Ù„Ù Ù…Ø­Ù„ÙŠ ØªØ§Ù„Ù.'); return; }
        window.formData = data;
        applyFormDataToInputs();
        alert('ØªÙ… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø­Ù‚Ù‘Ù‚ Ø§Ù„Ø­Ø§Ù„ÙŠ.');
      } catch (e) {
        alert('ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ø§Ø³ØªØ±Ø¬Ø§Ø¹.');
      }
    }

    function clearAll() {
      if (!confirm('Ø³ÙŠØªÙ… Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø©. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ')) return;
      window.formData = {};
      localStorage.removeItem(STORAGE_KEY);
      // Ø¥ÙØ±Ø§Øº Ø§Ù„Ø­Ù‚ÙˆÙ„
      document.querySelectorAll('input, textarea, select').forEach(el => {
        if (el.type === 'radio' || el.type === 'checkbox') el.checked = false;
        else el.value = '';
      });
      alert('ØªÙ… Ø§Ù„ØªÙØ±ÙŠØº.');
    }

    function applyFormDataToInputs() {
      // Ù…Ø±Ù‘Ø± Ø§Ù„Ù‚ÙŠÙ… Ù…Ù† formData Ø¥Ù„Ù‰ Ø§Ù„Ø­Ù‚ÙˆÙ„
      document.querySelectorAll('input, textarea, select').forEach(el => {
        const name = el.name;
        if (!name) return;
        const val = window.formData[name];
        const type = (el.type || '').toLowerCase();
        if (val === undefined) return;

        if (type === 'radio') {
          el.checked = (String(val) === String(el.value));
        } else if (type === 'checkbox') {
          if (Array.isArray(val)) {
            el.checked = val.includes(el.value);
          } else {
            el.checked = String(val) === String(el.value);
          }
        } else {
          el.value = val;
        }
      });
      updateProgress();
    }

    // ========= Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Google Apps Script (Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‘Ù‚) =========
    async function submitForm() {
      saveCurrentPageData();

      // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
      computeOverallScore();

      if (!validateForm()) {
        return; // Ù„Ø§ Ù†Ø±Ø³Ù„ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ø£Ø®Ø·Ø§Ø¡
      }

      const params = new URLSearchParams();
      for (const [k, v] of Object.entries(window.formData)) {
        if (Array.isArray(v)) params.append(k, v.join('; '));
        else params.append(k, v ?? '');
      }
      try {
        await fetch(APPS_SCRIPT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
          body: params.toString(),
          mode: 'no-cors'
        });
        alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ âœ”');
      } catch (e) {
        console.error(e);
        alert('ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯ Web App.');
      }
    }

    // ========= ØªÙ‡ÙŠØ¦Ø© =========
    function createItemPages() {
      const chunkSize = 6;
      const pagesWrap = document.getElementById('pages');
      let pageIndex = 2; // Ù„Ø¯ÙŠÙ†Ø§ page0, page1 Ù…Ø³Ø¨Ù‚Ù‹Ø§

      for (let i = 0; i < ITEM_NUMBERS.length; i += chunkSize) {
        const chunk = ITEM_NUMBERS.slice(i, i + chunkSize);
        const blocks = chunk.map(n => createItemBlock(n)).join('');
        const sec = document.createElement('section');
        sec.className = 'page';
        sec.id = 'page' + pageIndex;
        sec.innerHTML = `
          <h2>Ù…Ø­Ø§ÙˆØ± Ø§Ù„Ø¨Ù†ÙˆØ¯ (${chunk[0]}â€“${chunk[chunk.length - 1]})</h2>
          ${blocks}
          <div class="navigation-buttons">
            <button class="btn btn-secondary" type="button" onclick="prevPage()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
            <button class="btn" type="button" onclick="nextPage()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
          </div>
        `;
        pagesWrap.appendChild(sec);
        pageIndex++;
      }
    }

    function createItemBlock(n) {
      return `
        <div class="item-block">
          <h3>Ø§Ù„Ø¨Ù†Ø¯ ${n}</h3>
          <p class="hint"><em>Ø¶Ø¹ Ù†Øµ Ø§Ù„Ø¨Ù†Ø¯ Ù‡Ù†Ø§ Ù„Ùˆ Ø±ØºØ¨Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</em></p>

          <div class="grid">
            <div class="field">
              <label>Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ ÙˆØ¶ÙˆØ­</label>
              <div>
                ${[1,2,3,4,5].map(i => `<label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ ÙˆØ¶ÙˆØ­" value="${i}"> ${i}</label>`).join(' ')}
              </div>
            </div>

            <div class="field">
              <label>Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù…Ù„Ø§Ø¡Ù…Ø©</label>
              <div>
                ${[1,2,3,4,5].map(i => `<label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù…Ù„Ø§Ø¡Ù…Ø©" value="${i}"> ${i}</label>`).join(' ')}
              </div>
            </div>

            <div class="field">
              <label>Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ø´Ù…ÙˆÙ„ÙŠØ©</label>
              <div>
                ${[1,2,3,4,5].map(i => `<label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ø´Ù…ÙˆÙ„ÙŠØ©" value="${i}"> ${i}</label>`).join(' ')}
              </div>
            </div>

            <div class="field">
              <label>Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù‚Ø±Ø§Ø±</label>
              <div>
                <label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù‚Ø±Ø§Ø±" value="Ù…Ù†Ø§Ø³Ø¨"> Ù…Ù†Ø§Ø³Ø¨</label>
                <label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù‚Ø±Ø§Ø±" value="ÙŠØ­ØªØ§Ø¬ ØªØ¹Ø¯ÙŠÙ„"> ÙŠØ­ØªØ§Ø¬ ØªØ¹Ø¯ÙŠÙ„</label>
                <label><input type="radio" name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù‚Ø±Ø§Ø±" value="ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨"> ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨</label>
              </div>
            </div>
          </div>

          <div class="field">
            <label>Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
            <textarea name="Ø§Ù„Ø¨Ù†Ø¯ ${n} â€“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª" rows="3" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ø®ØªØµØ±Ø©"></textarea>
          </div>

          <hr />
        </div>
      `;
    }

    // Ø¥Ù†Ø´Ø§Ø¡ ØµÙØ­Ø§Øª Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø«Ù… ØªÙ‡ÙŠØ¦Ø©
    createItemPages();
    refreshPages();
    updateProgress();

    // ØªÙ„Ù…ÙŠØ­ ØµØºÙŠØ± Ù„Ùˆ ÙÙŠÙ‡ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©
    try {
      if (localStorage.getItem(STORAGE_KEY)) {
        console.log('Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠÙ‹Ø§ Ù…ØªÙˆÙØ±Ø©â€”Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± "Ø§Ø³ØªØ±Ø¬Ø§Ø¹".');
      }
    } catch (e) {}
  </script>
</body>
</html>
